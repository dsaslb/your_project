<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëª¨ë“ˆ ê°œë°œ ëª¨ë“œ - ë””ìì´ë„ˆ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/tailwind.css">
    <script src="/static/js/theme.js"></script>
</head>
<body class="bg-gray-50 dark:bg-gray-900">
    <div class="min-h-screen flex">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="w-64 bg-white dark:bg-gray-800 shadow-lg">
            <div class="p-6">
                <h1 class="text-2xl font-bold text-gray-900 dark:text-white">ğŸ”§ ëª¨ë“ˆ ê°œë°œ</h1>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">ê°œë°œì ë„êµ¬</p>
            </div>
            
            <nav class="mt-6">
                <div class="px-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ê°œë°œ ë„êµ¬</h3>
                </div>
                
                <a href="/dev-modules/" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-plus mr-3"></i>
                    ìƒˆ í”„ë¡œì íŠ¸
                </a>
                <a href="/dev-modules/designer" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900 border-r-2 border-blue-500">
                    <i class="fas fa-palette mr-3"></i>
                    ë””ìì´ë„ˆ
                </a>
                <a href="/dev-modules/editor" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-code mr-3"></i>
                    ì½”ë“œ ì—ë””í„°
                </a>
                <a href="/dev-modules/testing" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-vial mr-3"></i>
                    í…ŒìŠ¤íŠ¸
                </a>
                <a href="/dev-modules/deploy" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-rocket mr-3"></i>
                    ë°°í¬
                </a>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ê´€ë¦¬</h3>
                </div>
                
                <a href="/admin_dashboard" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-arrow-left mr-3"></i>
                    ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
                </a>
            </nav>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="flex-1 overflow-auto">
            <!-- í—¤ë” -->
            <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700">
                <div class="px-6 py-4">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">UI ë””ìì´ë„ˆ</h2>
                    <p class="text-gray-600 dark:text-gray-400 mt-1">ë“œë˜ê·¸ ì•¤ ë“œë¡­ìœ¼ë¡œ UI ì»´í¬ë„ŒíŠ¸ë¥¼ ë””ìì¸í•˜ì„¸ìš”</p>
                </div>
            </header>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <main class="p-6">
                <div class="grid grid-cols-12 gap-6 h-[calc(100vh-200px)]">
                    <!-- ì»´í¬ë„ŒíŠ¸ íŒ”ë ˆíŠ¸ -->
                    <div class="col-span-3 bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">ì»´í¬ë„ŒíŠ¸</h3>
                        
                        <div class="space-y-2">
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ê¸°ë³¸ ìš”ì†Œ</div>
                            
                            <div class="component-item" draggable="true" data-type="button">
                                <i class="fas fa-square mr-2"></i>
                                <span class="text-sm">ë²„íŠ¼</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="input">
                                <i class="fas fa-edit mr-2"></i>
                                <span class="text-sm">ì…ë ¥ í•„ë“œ</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="select">
                                <i class="fas fa-chevron-down mr-2"></i>
                                <span class="text-sm">ì„ íƒ ë°•ìŠ¤</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="table">
                                <i class="fas fa-table mr-2"></i>
                                <span class="text-sm">í…Œì´ë¸”</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="card">
                                <i class="fas fa-credit-card mr-2"></i>
                                <span class="text-sm">ì¹´ë“œ</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="modal">
                                <i class="fas fa-window-maximize mr-2"></i>
                                <span class="text-sm">ëª¨ë‹¬</span>
                            </div>
                            
                            <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 mt-4">ë ˆì´ì•„ì›ƒ</div>
                            
                            <div class="component-item" draggable="true" data-type="container">
                                <i class="fas fa-box mr-2"></i>
                                <span class="text-sm">ì»¨í…Œì´ë„ˆ</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="grid">
                                <i class="fas fa-th mr-2"></i>
                                <span class="text-sm">ê·¸ë¦¬ë“œ</span>
                            </div>
                            
                            <div class="component-item" draggable="true" data-type="sidebar">
                                <i class="fas fa-columns mr-2"></i>
                                <span class="text-sm">ì‚¬ì´ë“œë°”</span>
                            </div>
                        </div>
                    </div>

                    <!-- ë””ìì¸ ìº”ë²„ìŠ¤ -->
                    <div class="col-span-6 bg-white dark:bg-gray-800 rounded-lg shadow">
                        <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-medium text-gray-900 dark:text-white">ìº”ë²„ìŠ¤</h3>
                                <div class="flex space-x-2">
                                    <button id="preview-btn" class="px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700">
                                        <i class="fas fa-eye mr-1"></i>ë¯¸ë¦¬ë³´ê¸°
                                    </button>
                                    <button id="export-btn" class="px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700">
                                        <i class="fas fa-download mr-1"></i>ë‚´ë³´ë‚´ê¸°
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="design-canvas" class="p-6 min-h-[500px] bg-gray-50 dark:bg-gray-900">
                            <div class="text-center text-gray-500 dark:text-gray-400 py-20">
                                <i class="fas fa-mouse-pointer text-4xl mb-4"></i>
                                <p>ì»´í¬ë„ŒíŠ¸ë¥¼ ì—¬ê¸°ë¡œ ë“œë˜ê·¸í•˜ì—¬ ë””ìì¸ì„ ì‹œì‘í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>

                    <!-- ì†ì„± íŒ¨ë„ -->
                    <div class="col-span-3 bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">ì†ì„±</h3>
                        
                        <div id="properties-panel">
                            <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                                <i class="fas fa-cog text-2xl mb-2"></i>
                                <p class="text-sm">ì»´í¬ë„ŒíŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ì†ì„±ì„ í¸ì§‘í•˜ì„¸ìš”</p>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <style>
        .component-item {
            @apply flex items-center px-3 py-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded cursor-move;
        }
        
        .component-item:hover {
            @apply bg-blue-50 dark:bg-blue-900;
        }
        
        .design-component {
            @apply relative border-2 border-dashed border-gray-300 dark:border-gray-600 p-4 m-2 rounded;
        }
        
        .design-component.selected {
            @apply border-blue-500 bg-blue-50 dark:bg-blue-900;
        }
        
        .component-controls {
            @apply absolute top-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded shadow-sm;
        }
    </style>

    <script>
        let selectedComponent = null;
        let componentCounter = 0;

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
        document.querySelectorAll('.component-item').forEach(item => {
            item.addEventListener('dragstart', function(e) {
                e.dataTransfer.setData('text/plain', this.dataset.type);
            });
        });

        const canvas = document.getElementById('design-canvas');
        
        canvas.addEventListener('dragover', function(e) {
            e.preventDefault();
        });
        
        canvas.addEventListener('drop', function(e) {
            e.preventDefault();
            const componentType = e.dataTransfer.getData('text/plain');
            addComponent(componentType, e.offsetX, e.offsetY);
        });

        // ì»´í¬ë„ŒíŠ¸ ì¶”ê°€
        function addComponent(type, x, y) {
            const component = document.createElement('div');
            component.className = 'design-component';
            component.dataset.type = type;
            component.dataset.id = `component-${componentCounter++}`;
            
            // ì»´í¬ë„ŒíŠ¸ ë‚´ìš© ìƒì„±
            let content = '';
            switch(type) {
                case 'button':
                    content = '<button class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">ë²„íŠ¼</button>';
                    break;
                case 'input':
                    content = '<input type="text" class="px-3 py-2 border border-gray-300 rounded" placeholder="ì…ë ¥í•˜ì„¸ìš”">';
                    break;
                case 'select':
                    content = '<select class="px-3 py-2 border border-gray-300 rounded"><option>ì˜µì…˜ ì„ íƒ</option></select>';
                    break;
                case 'table':
                    content = `
                        <table class="min-w-full border border-gray-300">
                            <thead><tr><th class="border p-2">í—¤ë”</th></tr></thead>
                            <tbody><tr><td class="border p-2">ë°ì´í„°</td></tr></tbody>
                        </table>
                    `;
                    break;
                case 'card':
                    content = `
                        <div class="border border-gray-300 rounded p-4">
                            <h3 class="font-medium">ì¹´ë“œ ì œëª©</h3>
                            <p class="text-gray-600">ì¹´ë“œ ë‚´ìš©</p>
                        </div>
                    `;
                    break;
                case 'modal':
                    content = `
                        <div class="border border-gray-300 rounded p-4 bg-white">
                            <h3 class="font-medium">ëª¨ë‹¬ ì œëª©</h3>
                            <p class="text-gray-600">ëª¨ë‹¬ ë‚´ìš©</p>
                        </div>
                    `;
                    break;
                case 'container':
                    content = '<div class="border border-gray-300 rounded p-4 min-h-[100px]">ì»¨í…Œì´ë„ˆ</div>';
                    break;
                case 'grid':
                    content = '<div class="grid grid-cols-2 gap-4 border border-gray-300 rounded p-4">ê·¸ë¦¬ë“œ</div>';
                    break;
                case 'sidebar':
                    content = '<div class="border border-gray-300 rounded p-4 w-48">ì‚¬ì´ë“œë°”</div>';
                    break;
            }
            
            component.innerHTML = content;
            
            // ì»´í¬ë„ŒíŠ¸ ì»¨íŠ¸ë¡¤ ì¶”ê°€
            const controls = document.createElement('div');
            controls.className = 'component-controls';
            controls.innerHTML = `
                <button onclick="selectComponent(this.parentElement.parentElement)" class="p-1 hover:bg-gray-100">
                    <i class="fas fa-edit text-xs"></i>
                </button>
                <button onclick="deleteComponent(this.parentElement.parentElement)" class="p-1 hover:bg-gray-100 text-red-600">
                    <i class="fas fa-trash text-xs"></i>
                </button>
            `;
            component.appendChild(controls);
            
            // ìº”ë²„ìŠ¤ì— ì¶”ê°€
            canvas.appendChild(component);
            
            // ì»´í¬ë„ŒíŠ¸ ì„ íƒ
            selectComponent(component);
        }

        // ì»´í¬ë„ŒíŠ¸ ì„ íƒ
        function selectComponent(component) {
            // ì´ì „ ì„ íƒ í•´ì œ
            document.querySelectorAll('.design-component').forEach(c => c.classList.remove('selected'));
            
            // ìƒˆ ì»´í¬ë„ŒíŠ¸ ì„ íƒ
            component.classList.add('selected');
            selectedComponent = component;
            
            // ì†ì„± íŒ¨ë„ ì—…ë°ì´íŠ¸
            updatePropertiesPanel(component);
        }

        // ì»´í¬ë„ŒíŠ¸ ì‚­ì œ
        function deleteComponent(component) {
            component.remove();
            if (selectedComponent === component) {
                selectedComponent = null;
                updatePropertiesPanel(null);
            }
        }

        // ì†ì„± íŒ¨ë„ ì—…ë°ì´íŠ¸
        function updatePropertiesPanel(component) {
            const panel = document.getElementById('properties-panel');
            
            if (!component) {
                panel.innerHTML = `
                    <div class="text-center text-gray-500 dark:text-gray-400 py-10">
                        <i class="fas fa-cog text-2xl mb-2"></i>
                        <p class="text-sm">ì»´í¬ë„ŒíŠ¸ë¥¼ ì„ íƒí•˜ì—¬ ì†ì„±ì„ í¸ì§‘í•˜ì„¸ìš”</p>
                    </div>
                `;
                return;
            }
            
            const type = component.dataset.type;
            panel.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì»´í¬ë„ŒíŠ¸ ìœ í˜•</label>
                        <input type="text" value="${type}" readonly 
                               class="w-full px-3 py-2 border border-gray-300 rounded bg-gray-100 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ID</label>
                        <input type="text" value="${component.dataset.id}" readonly 
                               class="w-full px-3 py-2 border border-gray-300 rounded bg-gray-100 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">í´ë˜ìŠ¤</label>
                        <input type="text" id="component-class" 
                               class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                               onchange="updateComponentClass(this.value)">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ìŠ¤íƒ€ì¼</label>
                        <textarea id="component-style" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"
                                  onchange="updateComponentStyle(this.value)"
                                  placeholder="CSS ìŠ¤íƒ€ì¼ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                    </div>
                </div>
            `;
        }

        // ì»´í¬ë„ŒíŠ¸ í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸
        function updateComponentClass(className) {
            if (selectedComponent) {
                selectedComponent.className = `design-component ${className}`;
            }
        }

        // ì»´í¬ë„ŒíŠ¸ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        function updateComponentStyle(style) {
            if (selectedComponent) {
                selectedComponent.style.cssText = style;
            }
        }

        // ë¯¸ë¦¬ë³´ê¸° ë²„íŠ¼
        document.getElementById('preview-btn').addEventListener('click', function() {
            const components = document.querySelectorAll('.design-component');
            let html = '';
            
            components.forEach(component => {
                const clone = component.cloneNode(true);
                clone.classList.remove('design-component', 'selected');
                clone.removeAttribute('data-type');
                clone.removeAttribute('data-id');
                
                // ì»¨íŠ¸ë¡¤ ì œê±°
                const controls = clone.querySelector('.component-controls');
                if (controls) controls.remove();
                
                html += clone.outerHTML + '\n';
            });
            
            // ìƒˆ ì°½ì—ì„œ ë¯¸ë¦¬ë³´ê¸°
            const previewWindow = window.open('', '_blank');
            previewWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>UI ë¯¸ë¦¬ë³´ê¸°</title>
                    <link rel="stylesheet" href="/static/css/tailwind.css">
                </head>
                <body class="p-8">
                    ${html}
                </body>
                </html>
            `);
        });

        // ë‚´ë³´ë‚´ê¸° ë²„íŠ¼
        document.getElementById('export-btn').addEventListener('click', function() {
            const components = document.querySelectorAll('.design-component');
            let html = '';
            let css = '';
            
            components.forEach((component, index) => {
                const clone = component.cloneNode(true);
                clone.classList.remove('design-component', 'selected');
                clone.removeAttribute('data-type');
                clone.removeAttribute('data-id');
                
                // ì»¨íŠ¸ë¡¤ ì œê±°
                const controls = clone.querySelector('.component-controls');
                if (controls) controls.remove();
                
                html += `<!-- Component ${index + 1} -->\n${clone.outerHTML}\n\n`;
                
                // ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ì´ ìˆë‹¤ë©´ CSSë¡œ ì¶”ì¶œ
                if (component.style.cssText) {
                    css += `/* Component ${index + 1} */\n.component-${index + 1} {\n${component.style.cssText}\n}\n\n`;
                }
            });
            
            // ë‹¤ìš´ë¡œë“œ
            const blob = new Blob([`<!DOCTYPE html>\n<html>\n<head>\n<title>Exported UI</title>\n<style>\n${css}</style>\n</head>\n<body>\n${html}\n</body>\n</html>`], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ui-design.html';
            a.click();
            URL.revokeObjectURL(url);
        });
    </script>
</body>
</html>