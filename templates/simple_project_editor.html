{% extends "simple_base.html" %}

{% block title %}{{ project.name }} - ÌîÑÎ°úÏ†ùÌä∏ ÏóêÎîîÌÑ∞{% endblock %}

{% block content %}
<div class="h-screen flex flex-col">
    <!-- ÏÉÅÎã® Ìà¥Î∞î -->
    <div class="bg-white border-b border-gray-200 px-6 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <a href="/dev-mode" class="text-gray-600 hover:text-gray-900">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                </a>
                <div>
                    <h1 class="text-xl font-semibold text-gray-900">{{ project.name }}</h1>
                    <p class="text-sm text-gray-600">{{ project.description }}</p>
                </div>
            </div>
            <div class="flex items-center space-x-2">
                <button id="previewBtn" class="inline-flex items-center px-4 py-2 bg-green-600 text-white text-sm font-medium rounded-md hover:bg-green-700 transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                    </svg>
                    ÎØ∏Î¶¨Î≥¥Í∏∞
                </button>
                <button id="saveBtn" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700 transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                    </svg>
                    Ï†ÄÏû•
                </button>
                <button id="deployBtn" class="inline-flex items-center px-4 py-2 bg-purple-600 text-white text-sm font-medium rounded-md hover:bg-purple-700 transition-colors">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                    </svg>
                    Î∞∞Ìè¨
                </button>
            </div>
        </div>
    </div>

    <!-- Î©îÏù∏ Ïª®ÌÖêÏ∏† -->
    <div class="flex-1 flex">
        <!-- Ï¢åÏ∏°: Ïª¥Ìè¨ÎÑåÌä∏ ÌåîÎ†àÌä∏ -->
        <div class="w-80 bg-gray-50 border-r border-gray-200 overflow-y-auto">
            <div class="p-4">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Ïª¥Ìè¨ÎÑåÌä∏</h3>
                
                <!-- Í∏∞Î≥∏ Ïª¥Ìè¨ÎÑåÌä∏ -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Í∏∞Î≥∏</h4>
                    <div class="space-y-2">
                        {% for component in component_library.basic %}
                        <div class="component-item bg-white border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-blue-300 hover:shadow-sm transition-all"
                             data-component="{{ component | tojson }}">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">{{ component.icon }}</span>
                                <div>
                                    <div class="font-medium text-gray-900">{{ component.name }}</div>
                                    <div class="text-sm text-gray-600">{{ component.type }}</div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Í≥†Í∏â Ïª¥Ìè¨ÎÑåÌä∏ -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">Í≥†Í∏â</h4>
                    <div class="space-y-2">
                        {% for component in component_library.advanced %}
                        <div class="component-item bg-white border border-gray-200 rounded-lg p-3 cursor-pointer hover:border-blue-300 hover:shadow-sm transition-all"
                             data-component="{{ component | tojson }}">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">{{ component.icon }}</span>
                                <div>
                                    <div class="font-medium text-gray-900">{{ component.name }}</div>
                                    <div class="text-sm text-gray-600">{{ component.type }}</div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <!-- ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ -->
                <div class="mb-6">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞</h4>
                    <div class="space-y-2">
                        <button class="w-full text-left bg-white border border-gray-200 rounded-lg p-3 hover:border-green-300 hover:shadow-sm transition-all"
                                onclick="generateTestData('users')">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üë•</span>
                                <div>
                                    <div class="font-medium text-gray-900">ÏÇ¨Ïö©Ïûê Îç∞Ïù¥ÌÑ∞</div>
                                    <div class="text-sm text-gray-600">ÏÉòÌîå ÏÇ¨Ïö©Ïûê ÏÉùÏÑ±</div>
                                </div>
                            </div>
                        </button>
                        <button class="w-full text-left bg-white border border-gray-200 rounded-lg p-3 hover:border-green-300 hover:shadow-sm transition-all"
                                onclick="generateTestData('products')">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üì¶</span>
                                <div>
                                    <div class="font-medium text-gray-900">ÏÉÅÌíà Îç∞Ïù¥ÌÑ∞</div>
                                    <div class="text-sm text-gray-600">ÏÉòÌîå ÏÉÅÌíà ÏÉùÏÑ±</div>
                                </div>
                            </div>
                        </button>
                        <button class="w-full text-left bg-white border border-gray-200 rounded-lg p-3 hover:border-green-300 hover:shadow-sm transition-all"
                                onclick="generateTestData('orders')">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üìã</span>
                                <div>
                                    <div class="font-medium text-gray-900">Ï£ºÎ¨∏ Îç∞Ïù¥ÌÑ∞</div>
                                    <div class="text-sm text-gray-600">ÏÉòÌîå Ï£ºÎ¨∏ ÏÉùÏÑ±</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ï§ëÏïô: ÎîîÏûêÏù∏ Ï∫îÎ≤ÑÏä§ -->
        <div class="flex-1 bg-gray-100 overflow-auto">
            <div class="p-6">
                <div class="bg-white rounded-lg shadow-lg min-h-[600px] relative" id="designCanvas">
                    <div class="absolute top-4 left-4 text-sm text-gray-500">
                        Ï∫îÎ≤ÑÏä§Ïóê Ïª¥Ìè¨ÎÑåÌä∏Î•º ÎìúÎûòÍ∑∏ÌïòÏÑ∏Ïöî
                    </div>
                    
                    <!-- Ïª¥Ìè¨ÎÑåÌä∏Îì§Ïù¥ Ïó¨Í∏∞Ïóê Î†åÎçîÎßÅÎê©ÎãàÎã§ -->
                    {% for component in project.components %}
                    <div class="component-instance absolute border-2 border-dashed border-gray-300 rounded p-2 cursor-move"
                         data-component-id="{{ component.component_id }}"
                         style="left: {{ component.position_x }}px; top: {{ component.position_y }}px; width: {{ component.width }}px; height: {{ component.height }}px;">
                        <div class="component-content">
                            {% if component.type == 'button' %}
                            <button class="px-4 py-2 bg-blue-600 text-white rounded">{{ component.properties.text or 'Î≤ÑÌäº' }}</button>
                            {% elif component.type == 'card' %}
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h3 class="font-medium">{{ component.properties.title or 'Ïπ¥Îìú Ï†úÎ™©' }}</h3>
                                <p class="text-gray-600">{{ component.properties.content or 'Ïπ¥Îìú ÎÇ¥Ïö©' }}</p>
                            </div>
                            {% elif component.type == 'form' %}
                            <div class="bg-white border border-gray-200 rounded-lg p-4">
                                <h3 class="font-medium mb-3">{{ component.properties.title or 'Ìèº Ï†úÎ™©' }}</h3>
                                <div class="space-y-3">
                                    <input type="text" placeholder="ÏûÖÎ†•ÌïòÏÑ∏Ïöî" class="w-full px-3 py-2 border border-gray-300 rounded">
                                    <button class="px-4 py-2 bg-blue-600 text-white rounded">Ï†úÏ∂ú</button>
                                </div>
                            </div>
                            {% elif component.type == 'input' %}
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">{{ component.properties.label or 'ÎùºÎ≤®' }}</label>
                                <input type="{{ component.properties.type or 'text' }}" 
                                       placeholder="{{ component.properties.placeholder or 'ÏûÖÎ†•ÌïòÏÑ∏Ïöî' }}"
                                       class="w-full px-3 py-2 border border-gray-300 rounded">
                            </div>
                            {% elif component.type == 'table' %}
                            <div class="bg-white border border-gray-200 rounded-lg overflow-hidden">
                                <table class="w-full">
                                    <thead class="bg-gray-50">
                                        <tr>
                                            {% for header in component.properties.headers or ['Ïª¨Îüº1', 'Ïª¨Îüº2', 'Ïª¨Îüº3'] %}
                                            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">{{ header }}</th>
                                            {% endfor %}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for row in component.properties.data or [['Îç∞Ïù¥ÌÑ∞1', 'Îç∞Ïù¥ÌÑ∞2', 'Îç∞Ïù¥ÌÑ∞3']] %}
                                        <tr class="border-t border-gray-200">
                                            {% for cell in row %}
                                            <td class="px-4 py-2 text-sm text-gray-900">{{ cell }}</td>
                                            {% endfor %}
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            {% else %}
                            <div class="bg-gray-100 border border-gray-300 rounded p-4 text-center text-gray-600">
                                {{ component.name }}
                            </div>
                            {% endif %}
                        </div>
                        <div class="component-controls absolute -top-2 -right-2 hidden">
                            <button class="bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"
                                    onclick="deleteComponent('{{ component.component_id }}')">√ó</button>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Ïö∞Ï∏°: ÏÜçÏÑ± Ìå®ÎÑê -->
        <div class="w-80 bg-white border-l border-gray-200 overflow-y-auto">
            <div class="p-4">
                <h3 class="text-lg font-medium text-gray-900 mb-4">ÏÜçÏÑ±</h3>
                
                <!-- ÏÑ†ÌÉùÎêú Ïª¥Ìè¨ÎÑåÌä∏Í∞Ä ÏóÜÏùÑ Îïå -->
                <div id="noSelection" class="text-center py-8">
                    <div class="w-16 h-16 bg-gray-100 rounded-full mx-auto mb-4 flex items-center justify-center">
                        <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                    </div>
                    <p class="text-gray-600">Ïª¥Ìè¨ÎÑåÌä∏Î•º ÏÑ†ÌÉùÌïòÏó¨ ÏÜçÏÑ±ÏùÑ Ìé∏ÏßëÌïòÏÑ∏Ïöî</p>
                </div>

                <!-- ÏÑ†ÌÉùÎêú Ïª¥Ìè¨ÎÑåÌä∏ ÏÜçÏÑ± -->
                <div id="componentProperties" class="hidden">
                    <div class="space-y-4">
                        <!-- ÏúÑÏπò Î∞è ÌÅ¨Í∏∞ -->
                        <div>
                            <h4 class="text-sm font-medium text-gray-700 mb-2">ÏúÑÏπò Î∞è ÌÅ¨Í∏∞</h4>
                            <div class="grid grid-cols-2 gap-2">
                                <div>
                                    <label class="block text-xs text-gray-600">X</label>
                                    <input type="number" id="posX" class="w-full px-2 py-1 text-sm border border-gray-300 rounded">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600">Y</label>
                                    <input type="number" id="posY" class="w-full px-2 py-1 text-sm border border-gray-300 rounded">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600">ÎÑàÎπÑ</label>
                                    <input type="number" id="width" class="w-full px-2 py-1 text-sm border border-gray-300 rounded">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600">ÎÜíÏù¥</label>
                                    <input type="number" id="height" class="w-full px-2 py-1 text-sm border border-gray-300 rounded">
                                </div>
                            </div>
                        </div>

                        <!-- Ïª¥Ìè¨ÎÑåÌä∏Î≥Ñ ÏÜçÏÑ± -->
                        <div id="componentSpecificProps">
                            <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                        </div>

                        <!-- Ïä§ÌÉÄÏùº -->
                        <div>
                            <h4 class="text-sm font-medium text-gray-700 mb-2">Ïä§ÌÉÄÏùº</h4>
                            <div class="space-y-2">
                                <div>
                                    <label class="block text-xs text-gray-600">Î∞∞Í≤ΩÏÉâ</label>
                                    <input type="color" id="backgroundColor" class="w-full h-8 border border-gray-300 rounded">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600">ÌÖåÎëêÎ¶¨</label>
                                    <input type="text" id="border" class="w-full px-2 py-1 text-sm border border-gray-300 rounded" placeholder="1px solid #ddd">
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-600">Îë•Í∑º Î™®ÏÑúÎ¶¨</label>
                                    <input type="text" id="borderRadius" class="w-full px-2 py-1 text-sm border border-gray-300 rounded" placeholder="4px">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
let selectedComponent = null;
let componentLibrary = {{ component_library | tojson }};

// ÎìúÎûòÍ∑∏ Ïï§ ÎìúÎ°≠ Í∏∞Îä•
document.addEventListener('DOMContentLoaded', function() {
    const canvas = document.getElementById('designCanvas');
    const componentItems = document.querySelectorAll('.component-item');

    // Ïª¥Ìè¨ÎÑåÌä∏ ÎìúÎûòÍ∑∏ ÏãúÏûë
    componentItems.forEach(item => {
        item.addEventListener('dragstart', function(e) {
            const componentData = JSON.parse(this.dataset.component);
            e.dataTransfer.setData('text/plain', JSON.stringify(componentData));
        });
    });

    // Ï∫îÎ≤ÑÏä§Ïóê ÎìúÎ°≠
    canvas.addEventListener('dragover', function(e) {
        e.preventDefault();
    });

    canvas.addEventListener('drop', function(e) {
        e.preventDefault();
        const componentData = JSON.parse(e.dataTransfer.getData('text/plain'));
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        addComponent(componentData, x, y);
    });

    // Í∏∞Ï°¥ Ïª¥Ìè¨ÎÑåÌä∏ ÏÑ†ÌÉù
    document.querySelectorAll('.component-instance').forEach(component => {
        component.addEventListener('click', function(e) {
            e.stopPropagation();
            selectComponent(this);
        });
    });

    // Ï∫îÎ≤ÑÏä§ ÌÅ¥Î¶≠ Ïãú ÏÑ†ÌÉù Ìï¥Ï†ú
    canvas.addEventListener('click', function() {
        deselectComponent();
    });
});

// Ïª¥Ìè¨ÎÑåÌä∏ Ï∂îÍ∞Ä
async function addComponent(componentData, x, y) {
    const data = {
        type: componentData.type,
        name: componentData.name,
        position_x: Math.round(x),
        position_y: Math.round(y),
        width: 200,
        height: 100,
        properties: componentData.default_properties || {},
        styles: componentData.default_styles || {}
    };

    try {
        const response = await fetch(`/api/dev/projects/{{ project.project_id }}/components`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });

        const result = await response.json();
        if (result.success) {
            location.reload(); // Í∞ÑÎã®Ìïú ÏÉàÎ°úÍ≥†Ïπ®
        } else {
            alert('Ïª¥Ìè¨ÎÑåÌä∏ Ï∂îÍ∞Ä Ïã§Ìå®: ' + result.message);
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Ïª¥Ìè¨ÎÑåÌä∏ Ï∂îÍ∞Ä Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
    }
}

// Ïª¥Ìè¨ÎÑåÌä∏ ÏÑ†ÌÉù
function selectComponent(element) {
    // Ïù¥Ï†Ñ ÏÑ†ÌÉù Ìï¥Ï†ú
    document.querySelectorAll('.component-instance').forEach(comp => {
        comp.classList.remove('ring-2', 'ring-blue-500');
        comp.querySelector('.component-controls').classList.add('hidden');
    });

    // ÏÉà ÏÑ†ÌÉù
    element.classList.add('ring-2', 'ring-blue-500');
    element.querySelector('.component-controls').classList.remove('hidden');
    selectedComponent = element;

    // ÏÜçÏÑ± Ìå®ÎÑê ÌëúÏãú
    document.getElementById('noSelection').classList.add('hidden');
    document.getElementById('componentProperties').classList.remove('hidden');

    // ÏÜçÏÑ± Í∞í ÏÑ§Ï†ï
    const componentId = element.dataset.componentId;
    const component = {{ project.components | tojson }}.find(c => c.component_id === componentId);
    
    if (component) {
        document.getElementById('posX').value = component.position_x;
        document.getElementById('posY').value = component.position_y;
        document.getElementById('width').value = component.width;
        document.getElementById('height').value = component.height;
        
        // Ïª¥Ìè¨ÎÑåÌä∏Î≥Ñ ÏÜçÏÑ± Î†åÎçîÎßÅ
        renderComponentProperties(component);
    }
}

// Ïª¥Ìè¨ÎÑåÌä∏ ÏÑ†ÌÉù Ìï¥Ï†ú
function deselectComponent() {
    document.querySelectorAll('.component-instance').forEach(comp => {
        comp.classList.remove('ring-2', 'ring-blue-500');
        comp.querySelector('.component-controls').classList.add('hidden');
    });
    
    selectedComponent = null;
    document.getElementById('noSelection').classList.remove('hidden');
    document.getElementById('componentProperties').classList.add('hidden');
}

// Ïª¥Ìè¨ÎÑåÌä∏Î≥Ñ ÏÜçÏÑ± Î†åÎçîÎßÅ
function renderComponentProperties(component) {
    const container = document.getElementById('componentSpecificProps');
    container.innerHTML = '';

    const componentType = component.type;
    const componentTemplate = componentLibrary.basic.concat(componentLibrary.advanced)
        .find(c => c.type === componentType);

    if (componentTemplate && componentTemplate.default_properties) {
        const title = document.createElement('h4');
        title.className = 'text-sm font-medium text-gray-700 mb-2';
        title.textContent = 'ÏÜçÏÑ±';
        container.appendChild(title);

        Object.entries(componentTemplate.default_properties).forEach(([key, value]) => {
            const div = document.createElement('div');
            div.className = 'mb-2';
            
            const label = document.createElement('label');
            label.className = 'block text-xs text-gray-600';
            label.textContent = key;
            
            const input = document.createElement('input');
            input.type = typeof value === 'number' ? 'number' : 'text';
            input.className = 'w-full px-2 py-1 text-sm border border-gray-300 rounded';
            input.value = component.properties[key] || value;
            input.dataset.property = key;
            
            input.addEventListener('change', function() {
                updateComponentProperty(component.component_id, key, this.value);
            });
            
            div.appendChild(label);
            div.appendChild(input);
            container.appendChild(div);
        });
    }
}

// Ïª¥Ìè¨ÎÑåÌä∏ ÏÜçÏÑ± ÏóÖÎç∞Ïù¥Ìä∏
async function updateComponentProperty(componentId, property, value) {
    const updates = {};
    updates[property] = value;

    try {
        const response = await fetch(`/api/dev/projects/{{ project.project_id }}/components/${componentId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(updates)
        });

        const result = await response.json();
        if (!result.success) {
            alert('ÏÜçÏÑ± ÏóÖÎç∞Ïù¥Ìä∏ Ïã§Ìå®: ' + result.message);
        }
    } catch (error) {
        console.error('Error:', error);
        alert('ÏÜçÏÑ± ÏóÖÎç∞Ïù¥Ìä∏ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
    }
}

// Ïª¥Ìè¨ÎÑåÌä∏ ÏÇ≠Ï†ú
async function deleteComponent(componentId) {
    if (!confirm('Ïù¥ Ïª¥Ìè¨ÎÑåÌä∏Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;

    try {
        const response = await fetch(`/api/dev/projects/{{ project.project_id }}/components/${componentId}`, {
            method: 'DELETE'
        });

        const result = await response.json();
        if (result.success) {
            location.reload();
        } else {
            alert('Ïª¥Ìè¨ÎÑåÌä∏ ÏÇ≠Ï†ú Ïã§Ìå®: ' + result.message);
        }
    } catch (error) {
        console.error('Error:', error);
        alert('Ïª¥Ìè¨ÎÑåÌä∏ ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
    }
}

// ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ±
async function generateTestData(dataType) {
    try {
        const response = await fetch(`/api/dev/test-data/{{ project.project_id }}/${dataType}`, {
            method: 'POST'
        });

        const result = await response.json();
        if (result.success) {
            alert(`${dataType} ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÉùÏÑ±ÎêòÏóàÏäµÎãàÎã§.`);
        } else {
            alert('ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ïã§Ìå®: ' + result.message);
        }
    } catch (error) {
        console.error('Error:', error);
        alert('ÌÖåÏä§Ìä∏ Îç∞Ïù¥ÌÑ∞ ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.');
    }
}

// Ï†ÄÏû• Î≤ÑÌäº
document.getElementById('saveBtn').addEventListener('click', function() {
    alert('ÌîÑÎ°úÏ†ùÌä∏Í∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§.');
});

// ÎØ∏Î¶¨Î≥¥Í∏∞ Î≤ÑÌäº
document.getElementById('previewBtn').addEventListener('click', function() {
    window.open(`/dev-mode/projects/{{ project.project_id }}/preview`, '_blank');
});

// Î∞∞Ìè¨ Î≤ÑÌäº
document.getElementById('deployBtn').addEventListener('click', function() {
    if (confirm('Ïù¥ ÌîÑÎ°úÏ†ùÌä∏Î•º Î∞∞Ìè¨ÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
        // Î∞∞Ìè¨ Î°úÏßÅ
        alert('Î∞∞Ìè¨Í∞Ä ÏãúÏûëÎêòÏóàÏäµÎãàÎã§.');
    }
});
</script>
{% endblock %} 