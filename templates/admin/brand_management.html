<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¸Œëœë“œ ê´€ë¦¬ - your_program Manager</title>
    <link rel="stylesheet" href="/static/css/tailwind.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="/static/js/theme.js"></script>
</head>
<body class="bg-gray-50 dark:bg-gray-900">
    <div class="min-h-screen flex">
        <!-- ì‚¬ì´ë“œë°” -->
        <div class="w-64 bg-white dark:bg-gray-800 shadow-lg flex flex-col">
            <div class="p-6 flex-shrink-0">
                <h1 class="text-2xl font-bold text-gray-900 dark:text-white">ğŸ½ï¸ your_program</h1>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</p>
            </div>
            
            <nav class="mt-6 flex-1">
                <div class="px-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ë©”ì¸ ë©”ë‰´</h3>
                </div>
                
                <a href="/admin_dashboard" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-tachometer-alt mr-3"></i>
                    ëŒ€ì‹œë³´ë“œ
                </a>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ë¸Œëœë“œ ê´€ë¦¬</h3>
                </div>
                
                <div class="space-y-1">
                    <a href="/admin/brand-manager-approval" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                        <i class="fas fa-user-check mr-3"></i>
                        ë¸Œëœë“œ ê´€ë¦¬ì ìŠ¹ì¸
                    </a>
                    <a href="/admin/brand-management" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 bg-blue-50 dark:bg-blue-900 border-r-2 border-blue-500">
                        <i class="fas fa-building mr-3"></i>
                        ë¸Œëœë“œë³„ ê´€ë¦¬
                    </a>
                </div>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ë§¤ì¥ ê´€ë¦¬</h3>
                </div>
                
                <a href="/admin/store-management" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-store mr-3"></i>
                    ë§¤ì¥ë³„ ê´€ë¦¬
                </a>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ì§ì› ê´€ë¦¬</h3>
                </div>
                
                <a href="/admin/employee-management" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-users mr-3"></i>
                    ì§ì›ë³„ ê´€ë¦¬
                </a>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ëª¨ë“ˆ/í”ŒëŸ¬ê·¸ì¸</h3>
                </div>
                
                <a href="/admin/module-marketplace" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-puzzle-piece mr-3"></i>
                    ëª¨ë“ˆ ë§ˆì¼“í”Œë ˆì´ìŠ¤
                </a>
                <a href="/admin/module-management" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-cogs mr-3"></i>
                    ëª¨ë“ˆ ê´€ë¦¬
                </a>
                
                <div class="px-6 mt-6 mb-4">
                    <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider">ì‹œìŠ¤í…œ ê´€ë¦¬</h3>
                </div>
                
                <a href="/admin/feedback-management" class="flex items-center px-6 py-3 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700">
                    <i class="fas fa-comments mr-3"></i>
                    í”¼ë“œë°± ê´€ë¦¬
                </a>
            </nav>
            
            <div class="p-6 flex-shrink-0 border-t border-gray-200 dark:border-gray-700">
                <div class="flex items-center justify-between">
                    <button id="theme-toggle" class="theme-toggle-btn" title="í…Œë§ˆ ë³€ê²½">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </button>
                    <a href="/auth/logout" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                        <i class="fas fa-sign-out-alt"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- ë©”ì¸ ì½˜í…ì¸  -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- í—¤ë” -->
            <header class="bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700 flex-shrink-0">
                <div class="px-6 py-4">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">ë¸Œëœë“œ ê´€ë¦¬</h2>
                    <p class="text-gray-600 dark:text-gray-400 mt-1">ë¸Œëœë“œ ìƒì„±, ìˆ˜ì •, ì‚­ì œ ë° ê´€ë¦¬</p>
                </div>
            </header>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <main class="flex-1 overflow-auto p-6">
                <div class="container mx-auto px-4 py-8">
                    <div class="flex justify-between items-center mb-6">
                        <h1 class="text-3xl font-bold text-gray-900 dark:text-white">ë¸Œëœë“œ ê´€ë¦¬</h1>
                        <button onclick="openCreateModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            ìƒˆ ë¸Œëœë“œ ì¶”ê°€
                        </button>
                    </div>

                    <!-- ë¸Œëœë“œ ëª©ë¡ -->
                    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
                        <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                            <h2 class="text-xl font-semibold text-gray-800 dark:text-white">ë¸Œëœë“œ ëª©ë¡</h2>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                <thead class="bg-gray-50 dark:bg-gray-700">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ë¸Œëœë“œëª…</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ë¸Œëœë“œ ì½”ë“œ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ì—…ì¢…</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìƒíƒœ</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ìƒì„±ì¼</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ê´€ë¦¬</th>
                                    </tr>
                                </thead>
                                <tbody id="brandList" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                    <!-- ë¸Œëœë“œ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

<!-- ë¸Œëœë“œ ìƒì„± ëª¨ë‹¬ -->
<div id="createBrandModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800">
        <div class="mt-3">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">ìƒˆ ë¸Œëœë“œ ì¶”ê°€</h3>
                <button onclick="closeCreateModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="createBrandForm" class="space-y-4">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <!-- ì—…ì¢… ì„ íƒ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì—…ì¢… *</label>
                    <select id="industrySelect" name="industry_name" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" required>
                        <option value="">ì—…ì¢…ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>

                <!-- ë¸Œëœë“œëª… -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ë¸Œëœë“œëª… *</label>
                    <input type="text" id="brandName" name="name" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" required>
                </div>

                <!-- ë¸Œëœë“œ ì½”ë“œ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ë¸Œëœë“œ ì½”ë“œ</label>
                    <div class="flex space-x-2">
                        <input type="text" id="brandCode" name="code" class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="ìë™ ìƒì„±ë©ë‹ˆë‹¤">
                        <button type="button" onclick="generateBrandCode()" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-md text-sm">
                            ìë™ ìƒì„±
                        </button>
                    </div>
                    <div id="codeSuggestions" class="mt-2 space-y-1 hidden">
                        <p class="text-sm text-gray-600 dark:text-gray-400">ì¶”ì²œ ì½”ë“œ:</p>
                        <div id="suggestionButtons" class="flex flex-wrap gap-2">
                            <!-- ì œì•ˆ ë²„íŠ¼ë“¤ì´ ì—¬ê¸°ì— ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>
                </div>

                <!-- ì„¤ëª… -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì„¤ëª…</label>
                    <textarea id="brandDescription" name="description" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"></textarea>
                </div>

                <!-- ì—°ë½ì²˜ ì •ë³´ -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì´ë©”ì¼</label>
                        <input type="email" id="brandEmail" name="contact_email" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì „í™”ë²ˆí˜¸</label>
                        <input type="tel" id="brandPhone" name="contact_phone" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                    </div>
                </div>

                <!-- ì›¹ì‚¬ì´íŠ¸ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì›¹ì‚¬ì´íŠ¸</label>
                    <input type="url" id="brandWebsite" name="website" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                </div>

                <!-- ì£¼ì†Œ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì£¼ì†Œ</label>
                    <input type="text" id="brandAddress" name="address" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                </div>

                <!-- í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ ìƒì„± -->
                <div class="flex items-center">
                    <input type="checkbox" id="createFrontendServer" name="create_frontend_server" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" checked>
                    <label for="createFrontendServer" class="ml-2 block text-sm text-gray-900 dark:text-white">
                        í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ ìë™ ìƒì„±
                    </label>
                </div>

                <!-- ë²„íŠ¼ -->
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeCreateModal()" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 dark:text-gray-200 rounded-md">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md">
                        ë¸Œëœë“œ ìƒì„±
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- ë¸Œëœë“œ ìˆ˜ì • ëª¨ë‹¬ -->
<div id="editBrandModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
    <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white dark:bg-gray-800">
        <div class="mt-3">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">ë¸Œëœë“œ ìˆ˜ì •</h3>
                <button onclick="closeEditModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <form id="editBrandForm" class="space-y-4">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                <input type="hidden" id="editBrandId">
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ë¸Œëœë“œëª… *</label>
                    <input type="text" id="editBrandName" name="name" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" required>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì„¤ëª…</label>
                    <textarea id="editBrandDescription" name="description" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì´ë©”ì¼</label>
                        <input type="email" id="editBrandEmail" name="contact_email" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì „í™”ë²ˆí˜¸</label>
                        <input type="tel" id="editBrandPhone" name="contact_phone" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì›¹ì‚¬ì´íŠ¸</label>
                    <input type="url" id="editBrandWebsite" name="website" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ì£¼ì†Œ</label>
                    <input type="text" id="editBrandAddress" name="address" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ìƒíƒœ</label>
                    <select id="editBrandStatus" name="status" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                        <option value="active">í™œì„±</option>
                        <option value="inactive">ë¹„í™œì„±</option>
                        <option value="suspended">ì¼ì‹œì •ì§€</option>
                    </select>
                </div>

                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="closeEditModal()" class="px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 dark:text-gray-200 rounded-md">
                        ì·¨ì†Œ
                    </button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md">
                        ìˆ˜ì •
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
let industries = [];

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
    loadIndustries();
    loadBrands();
});

// ì—…ì¢… ëª©ë¡ ë¡œë“œ
async function loadIndustries() {
    try {
        const response = await fetch('/api/admin/industries');
        const data = await response.json();
        
        if (response.ok) {
            industries = data.industries;
            const industrySelect = document.getElementById('industrySelect');
            
            // ê¸°ì¡´ ì˜µì…˜ ì œê±° (ì²« ë²ˆì§¸ ì˜µì…˜ ì œì™¸)
            while (industrySelect.children.length > 1) {
                industrySelect.removeChild(industrySelect.lastChild);
            }
            
            // ì—…ì¢… ì˜µì…˜ ì¶”ê°€
            industries.forEach(industry => {
                const option = document.createElement('option');
                option.value = industry.name;
                option.textContent = industry.name;
                industrySelect.appendChild(option);
            });
        } else {
            console.error('ì—…ì¢… ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', data.error);
        }
    } catch (error) {
        console.error('ì—…ì¢… ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
}

// ë¸Œëœë“œ ëª©ë¡ ë¡œë“œ
async function loadBrands() {
    try {
        const response = await fetch('/api/admin/brands');
        const data = await response.json();
        
        if (response.ok) {
            displayBrands(data.brands);
        } else {
            console.error('ë¸Œëœë“œ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', data.error);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
    }
}

// ë¸Œëœë“œ ëª©ë¡ í‘œì‹œ
function displayBrands(brands) {
    const brandList = document.getElementById('brandList');
    brandList.innerHTML = '';
    
    if (brands.length === 0) {
        brandList.innerHTML = `
            <tr>
                <td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">
                    ë“±ë¡ëœ ë¸Œëœë“œê°€ ì—†ìŠµë‹ˆë‹¤.
                </td>
            </tr>
        `;
        return;
    }
    
    brands.forEach(brand => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm font-medium text-gray-900 dark:text-white">${brand.name}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900 dark:text-white font-mono">${brand.code}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-gray-900 dark:text-white">-</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${
                    brand.status === 'active' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' : 
                    brand.status === 'inactive' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200' : 
                    'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'
                }">
                    ${brand.status === 'active' ? 'í™œì„±' : brand.status === 'inactive' ? 'ë¹„í™œì„±' : 'ì¼ì‹œì •ì§€'}
                </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">
                ${brand.created_at ? new Date(brand.created_at).toLocaleDateString() : '-'}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                <button onclick="editBrand(${brand.id})" class="text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3">ìˆ˜ì •</button>
                <button onclick="deleteBrand(${brand.id})" class="text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300">ì‚­ì œ</button>
            </td>
        `;
        brandList.appendChild(row);
    });
}

// ë¸Œëœë“œ ì½”ë“œ ìë™ ìƒì„±
async function generateBrandCode() {
    const industryName = document.getElementById('industrySelect').value;
    const brandName = document.getElementById('brandName').value;
    
    if (!industryName || !brandName) {
        alert('ì—…ì¢…ê³¼ ë¸Œëœë“œëª…ì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
    }
    
    try {
        const response = await fetch('/api/admin/brands/code-suggestions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                industry_name: industryName,
                brand_name: brandName
            })
        });
        
        const data = await response.json();
        
        if (response.ok) {
            // ìë™ ìƒì„±ëœ ì½”ë“œë¥¼ ì…ë ¥ í•„ë“œì— ì„¤ì •
            document.getElementById('brandCode').value = data.auto_generated;
            
            // ì œì•ˆ ì½”ë“œë“¤ í‘œì‹œ
            displayCodeSuggestions(data.suggestions);
        } else {
            console.error('ë¸Œëœë“œ ì½”ë“œ ìƒì„± ì‹¤íŒ¨:', data.error);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ì½”ë“œ ìƒì„± ì˜¤ë¥˜:', error);
    }
}

// ì œì•ˆ ì½”ë“œ í‘œì‹œ
function displayCodeSuggestions(suggestions) {
    const suggestionsDiv = document.getElementById('codeSuggestions');
    const buttonsDiv = document.getElementById('suggestionButtons');
    
    buttonsDiv.innerHTML = '';
    
    suggestions.forEach(suggestion => {
        const button = document.createElement('button');
        button.type = 'button';
        button.className = 'px-3 py-1 bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-600 dark:hover:bg-gray-500 dark:text-white rounded text-sm';
        button.textContent = suggestion;
        button.onclick = () => {
            document.getElementById('brandCode').value = suggestion;
        };
        buttonsDiv.appendChild(button);
    });
    
    suggestionsDiv.classList.remove('hidden');
}

// ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
function openCreateModal() {
    document.getElementById('createBrandModal').classList.remove('hidden');
    document.getElementById('createBrandForm').reset();
    document.getElementById('codeSuggestions').classList.add('hidden');
}

function closeCreateModal() {
    document.getElementById('createBrandModal').classList.add('hidden');
}

function openEditModal() {
    document.getElementById('editBrandModal').classList.remove('hidden');
}

function closeEditModal() {
    document.getElementById('editBrandModal').classList.add('hidden');
}

// ë¸Œëœë“œ ìƒì„±
document.getElementById('createBrandForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());
    
    // ì²´í¬ë°•ìŠ¤ ê°’ ì²˜ë¦¬
    data.create_frontend_server = document.getElementById('createFrontendServer').checked;
    
    try {
        const response = await fetch('/api/admin/brands', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': data.csrf_token
            },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (response.ok) {
            console.log('ë¸Œëœë“œ ìƒì„± ì„±ê³µ:', result);
            alert('ë¸Œëœë“œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì„œë²„ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.');
            closeCreateModal();
            
            // ìƒì„±ëœ ë¸Œëœë“œì˜ ì„œë²„ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™
            if (result.brand && result.brand.id) {
                console.log('ì„œë²„ ì„¤ì • í˜ì´ì§€ë¡œ ì´ë™:', `/admin/brand/${result.brand.id}/server-setup`);
                window.location.href = `/admin/brand/${result.brand.id}/server-setup`;
            } else {
                console.log('ë¸Œëœë“œ ì •ë³´ê°€ ì—†ì–´ ë¸Œëœë“œ ëª©ë¡ì„ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.');
                loadBrands();
            }
        } else {
            let errorMessage = 'ë¸Œëœë“œ ìƒì„± ì‹¤íŒ¨: ' + result.error;
            if (result.traceback) {
                console.error('ë¸Œëœë“œ ìƒì„± ì˜¤ë¥˜ ìƒì„¸:', result.traceback);
                errorMessage += '\n\nìƒì„¸ ì˜¤ë¥˜ëŠ” ë¸Œë¼ìš°ì € ì½˜ì†”ì„ í™•ì¸í•˜ì„¸ìš”.';
            }
            alert(errorMessage);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ìƒì„± ì˜¤ë¥˜:', error);
        alert('ë¸Œëœë“œ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
});

// ë¸Œëœë“œ ìˆ˜ì •
async function editBrand(brandId) {
    try {
        const response = await fetch(`/api/admin/brands/${brandId}`);
        const data = await response.json();
        
        if (response.ok) {
            const brand = data.brand;
            
            document.getElementById('editBrandId').value = brand.id;
            document.getElementById('editBrandName').value = brand.name;
            document.getElementById('editBrandDescription').value = brand.description || '';
            document.getElementById('editBrandEmail').value = brand.contact_email || '';
            document.getElementById('editBrandPhone').value = brand.contact_phone || '';
            document.getElementById('editBrandWebsite').value = brand.website || '';
            document.getElementById('editBrandAddress').value = brand.address || '';
            document.getElementById('editBrandStatus').value = brand.status;
            
            openEditModal();
        } else {
            alert('ë¸Œëœë“œ ì •ë³´ ë¡œë“œ ì‹¤íŒ¨: ' + data.error);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:', error);
        alert('ë¸Œëœë“œ ì •ë³´ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}

// ë¸Œëœë“œ ìˆ˜ì • í¼ ì œì¶œ
document.getElementById('editBrandForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const brandId = document.getElementById('editBrandId').value;
    const formData = new FormData(this);
    const data = Object.fromEntries(formData.entries());
    
    try {
        const response = await fetch(`/api/admin/brands/${brandId}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': data.csrf_token
            },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (response.ok) {
            alert('ë¸Œëœë“œê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            closeEditModal();
            loadBrands();
        } else {
            alert('ë¸Œëœë“œ ìˆ˜ì • ì‹¤íŒ¨: ' + result.error);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ìˆ˜ì • ì˜¤ë¥˜:', error);
        alert('ë¸Œëœë“œ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
});

// ë¸Œëœë“œ ì‚­ì œ
async function deleteBrand(brandId) {
    if (!confirm('ì •ë§ë¡œ ì´ ë¸Œëœë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        return;
    }
    
    // CSRF í† í° ê°€ì ¸ì˜¤ê¸°
    const csrfToken = document.querySelector('input[name="csrf_token"]').value;
    
    try {
        const response = await fetch(`/api/admin/brands/${brandId}`, {
            method: 'DELETE',
            headers: {
                'X-CSRFToken': csrfToken
            }
        });
        
        const result = await response.json();
        
        if (response.ok) {
            alert('ë¸Œëœë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            loadBrands();
        } else {
            alert('ë¸Œëœë“œ ì‚­ì œ ì‹¤íŒ¨: ' + result.error);
        }
    } catch (error) {
        console.error('ë¸Œëœë“œ ì‚­ì œ ì˜¤ë¥˜:', error);
        alert('ë¸Œëœë“œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
}
</script>
</body>
</html> 